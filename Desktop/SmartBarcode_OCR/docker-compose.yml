version: '3.8'

services:
  scanner:
    build: .
    container_name: smart_scanner
    ports:
      - "8501:8501"  # เปิด Port สำหรับ Streamlit (ถ้าใช้) หรือ API
    volumes:
      - ./data:/app/data  # เชื่อมโฟลเดอร์ data ตามภาพเดิม
    
    # --- ส่วนที่เพิ่มเพื่อเปิดใช้ GPU (RTX 3050 Ti) ---
    deploy:
      resources:
        reservations:
          devices:
            - driver: nvidia
              count: 1
              capabilities: [gpu]
    
    environment:
      - NVIDIA_VISIBLE_DEVICES=all
      - NVIDIA_DRIVER_CAPABILITIES=compute,utility
    # -----------------------------------------------
    
    tty: true